---
layout: post
title: 鱼还是熊掌？——使用分支结构
category: 初学者的第一套Java教程
tags: Java 入门
keywords: 蓝桥 lanqiao 教程 java Java8 循环 分支 运算符
description: 人生处处面临选择，往往鱼和熊掌我们只能选其一；程序的执行路径和现实相似，在某些节点会面临选择，本章我们讲述程序中的分支结构。
author: 付天有
importance: 4
order: 4
---

> 计算机是模拟大脑在工作，而程序就是我们大脑思维的描述。我们在思考时会遇到各种各样的岔路，比如*如果今天天气好，我就去江边游玩。如果我老板给我加薪，我就大吃一顿。*JAVA程序必须有能力来描述这种逻辑。

- 条件运算符
- if,if-else语法
- switch-case语法
 
# 实验一 判断奇偶

> 捕获控制台输入一个整数，如果这个数是偶数，则打印"X是一个偶数",如果是一个奇数，则打印"X是一个奇数"。

## 1 思路

与我们之前写过的程序不同，我们的程序不再是仅仅有一种可能，程序会根据输入的内容，给出不同的执行结果。先整理思绪，写出伪代码。

	//类声明
	{
		//主方法声明
		{
			//控制台内容捕获器
			//等待获取控制台输入整数内容，并赋给变量num
			//声明输出结果
			//判断数字奇偶性（是否能被2整除）
			//打印结果
		}
	}		

**利用注释编写伪代码是一种非常有效的思路梳理方法，我们根据注释所写的逻辑顺序，依次编写相应代码。**

## 2 关键技术

在判断数字奇偶时，我们需要用到两个关键技术，**`a%b`(取余运算符，又叫取模运算,结果是a除以b的余数)**和**a?b:c(条件运算符)**

## 3 编程
	
	import java.util.Scanner;
	
	//类声明
	public class ParityCheck {
		//主方法声明
		public static void main(String[] args) {
			//控制台内容捕获器
			Scanner scanner = new Scanner(System.in);
			
			//等待获取控制台输入整数内容，并出入变量num
			int num = scanner.nextInt();
			
			//声明输出结果
			String result;
			
			//判断数字奇偶性（是否能被2整除），根据不同逻辑赋值给输出结果
			result = (num%2==0?"这是一个偶数":"这是一个奇数");
			
			//打印结果
			System.out.println(result);
		}
	}

## 4 关于取模运算符

判断一个数的奇偶性最直接的办法就是这个数能否被2整除，我们之前学习过除法运算`/`，运算结果为除法的商，而`%`的结果就是除法的余数。

	int num = 10%3; // num的值为1

## 5 判断相等的运算符

`num%2==0`中，`==`的意义为判断`==`左右表达式的值是否相等，表达式结果为boolean型，即true或false。**一定要区分`=`和`==`区别**。

- `=`是赋值运算符，`int a = 10;`是把一个变量或字面值赋值给另一个变量。
- `==`是关系运算符，`boolean b = (1==2);`运算结果是一个boolean型，b为false;

## 6 其他关系运算符

关系运算符的表达方式和数学中类似，除了等值关系判断，还有大于小于等判断。

下表为Java支持的关系运算符，表格中的整数变量A的值为10，变量B的值为20：

![关系运算符](http://lemon.lanqiao.org:8082/teaching/img/Java8/relationOperation.png)

## 7 条件运算符

我们运用了条件运算符`a?b:c`，这个运算符的结果是b或c其中一个，而a是一个boolean表达式。如果a这个布尔表达式为`true`，则`a?b:c`结果为b,否则为c。
	
	// num能被2整除则result结果为"这是一个偶数"否则是"这是一个奇数"。
	result = (num%2 == 0 ? "这是一个偶数" : "这是一个奇数");

## 8 条件运算符的不足

我们利用条件运算符描述了一种简单的分支逻辑，让我们的程序能够根据运行时状态来执行不同的操作。

尝试分析如下流程

![注册流程](http://lemon.lanqiao.org:8082/teaching/img/Java8/分支流程.png)

这种逻辑分支较多，且存在嵌套，如果使用条件运算符来描述这种逻辑，会比较复杂而且程序可读性会很差。

# 实验二 使用if-else改进实验一

## 1 实现

	import java.util.Scanner;
	//类声明
	public class ParityCheckIf {
		//主方法声明
			public static void main(String[] args) {
				...

				//声明输出结果
				String result;
				
				//判断数字奇偶性（是否能被2整除），根据不同逻辑赋值给输出结果
				if(num%2==0) {
					result = "这是一个偶数";
				}else {
					result = "这是一个奇数";
				}
				//打印结果
				System.out.println(result);
			}
	}

## 2 关于if-else

`if...else`结构比较容易理解，结构为

	if(条件) {
		// 条件成立(true)所执行语句
	}else {
		// 条件不成立(false)所执行的语句
	}

其中else语句是可选的，`if(){}`可以单独出现

## 3 if-else if

`if...else`结构还有一些变化

	//条件1不成立时，再判断条件2
	if(条件1){

	}else if(条件2){
		
	}...

注意：如果没有`else`,仅`if...if...`结构时，后续的`if`无论之前条件是否成立都会重新判断，也就是说两个`if`在语法上并没有紧密的关联。

而`if...else if`结构的第二块仅在前置条件（第一个`if`块）不成立时才进行判断。

	int num = 10;
	if(num > 0) {
		System.out.println("这个数是正数");
	}else if(num%2==0) {//此时如果去掉else,无论num等于几，这个逻辑还是会判断
		System.out.println("这个数是偶数，而且是个负数");
	}

进一步改写：

	int num = 10;
	if(num > 0) {
		System.out.println("这个数是正数");
	}else if(num%2==0) {//此时如果去掉else,无论num等于几，这个逻辑还是会判断
		System.out.println("这个数是偶数，而且是个负数");
	}else{
		System.out.println("这个数是奇数，而且是个负数");
	}

最后一个`else`块，再前面判断都为`false`的情况下被执行。	

## 4 分支嵌套

	if(条件1){
		if(子条件1){
		
		}...
	}...

此处仅列出语法范式，以后我么会遇到实际案例。



# 实验三 判断输入的年份是否为闰年

>从控制台输入一个年份，程序自动判断该年份是否为闰年。

基本知识：满足以下条件之一可被判定为闰年

1、能被4整除但不能被100整除

2、能被400整除

## 1 分析

条件1和条件2构成了一个"或关系"，即条件1和条件2成立一个即可判定为闰年。

条件1中，`能被4整除`和`不能被100整除`构成了"与关系",即两者同时成立才能判定成立。

故逻辑判定的布尔表达式为

	(year%4 == 0 && year%100 != 0) || year%400 == 0

## 2 代码
	
	import java.util.Scanner;
	
	public class LeapYear {
		public static void main(String[] args) {
			Scanner scanner = new Scanner(System.in);
			int year = scanner.nextInt();
			if((year%4==0 && year%100!=0) || year%400==0){
				System.out.println(year + "是闰年");
			}else{
				System.out.println(year + "不是闰年");
			}
		}
	}

## 3 关于逻辑运算符

在使用分支结构时，我们使用了较多的boolean表达式（布尔表达式），目前我们使用的布尔表达式可以通过关系运算符（==、!=、>、>=、<=）获得，还可以通过**逻辑运算符**组装获得。

下表列出了逻辑运算符的基本运算，假设布尔变量A为真，变量B为假

![逻辑运算符](http://lemon.lanqiao.org:8082/teaching/img/Java8/logicOperation.png)

注意：A和B都必须是布尔类型表达式。运算符中还有`|`和`&`运算符，与`&&`和`||`有所不同。参考[http://www.runoob.com/java/java-operators.html](http://www.runoob.com/java/java-operators.html "运算符")中*位运算*一节。

# 实验四 商场搞活动啦

> 商场周年庆酬宾，全场满500全单95折，满1000全单88折，满2000全单8折，满5000尊享66折，根据输入的总价格，给出需要结算的金额。

## 1 伪代码

	//类与主方法声明...
	//获取总金额
	//声明结算价格
	//0<总价格<500   	 结算金额=总价格*1.0
	//500<总价格<1000	 结算金额=总价格*0.95
	//1000<总价格<2000	 结算金额=总价格*0.88
	//2000<总价格<5000	 结算金额=总价格*0.8
	//总价格>5000    	 结算金额=总价格*0.66

## 2 if实现

	public class PriceCalculation {
	
		public static void main(String[] args) {
			//获取总金额
			Scanner scanner = new Scanner(System.in);
			float total = scanner.nextFloat();
			//声明结算价格
			float finalPrice;
			if(total>0 && total<500){
				//0<总价格<500   	 结算金额=总价格*1.0
				finalPrice = total*1.0f;
			}else if(total>=500 && total<1000){
				//500<总价格<1000	 结算金额=总价格*0.95
				finalPrice = total*0.95f;
			}else if(total>=1000 && total<2000){
				//1000<总价格<2000	 结算金额=总价格*0.88
				finalPrice = total*0.88f;
			}else if(total>=2000 && total<5000){
				//2000<总价格<5000	 结算金额=总价格*0.8
				finalPrice = total*0.8f;
			}else if(total>=5000){
				//总价格>5000    	 结算金额=总价格*0.66
				finalPrice = total*0.66f;
			}else{
				//以上条件都不符合，则价格不在参考区间
				System.out.println("价格输入有误!");
				return; //不再执行以后的语句，退出main方法
			}
			System.out.println("消费的最终价格为"+finalPrice);
		}
	}

此实现中规中矩，逻辑上没有任何问题，但是繁杂的判断也让我们足够头疼。

其中最后的else我们加入了容错提示，及当我们输入的数字小于0时，我们程序不会输出最终价格。`return`关键字会退出当前方法，我们目前都是在main方法中编程，main方法退出后，程序就终止了。

## 3 switch...case语法介绍

	switch(表达式){
		case  字面值1:
			代码块A;
			break;
		case  字面值2:
			代码块B;
			break;
		…
		default:
			代码块X;
			break;
	}

`switch`关键字表示“开关”，当表达式与`case`后的字面值相等时，开关被打开，匹配的`case`以后的代码会被执行。尤其需要注意的是，这个表达式的值只允许是`byte`、`short`、`int`和`char`类型（在JDK 7.0中表达式的值可以是`String`类型）。

`case`后必须要跟一个与表达式类型对应的常量，`case`可以有多个，且顺序可以改变，但是每个`case`后面的常量值必须不同。当表达式的实际值与`case`后的常量相等时，其后的代码块就会执行。

`default`表示当表达式的实际值没有匹配到前面对应的任何`case`常量，`default`后面的默认代码块会被执行，`default`通常放在末尾。

`break`表示跳出当前结构，必须注意：如果没有`break`，"开关打开"后，随后每一个`case`中的语句都会被执行，直到结构最末或者遇到`break`。

## 4 switch实现

	import java.util.Scanner;
	public class SwitchImpl {
		public static void main(String[] args) {
			//获取总金额
			Scanner scanner = new Scanner(System.in);
			float total = scanner.nextFloat();
			//声明结算价格
			float finalPrice;
			//价格分级，结果为总价格/500的整除结果
			int grade = (int)total/500;
			System.out.println("您的折扣等级为"+grade);
			switch (grade) {
			case 0:
				//0<总价格<500   	 结算金额=总价格*1.0
				finalPrice = total*1.0f;
				break;
			case 1:
				//500<总价格<1000	 结算金额=总价格*0.95
				finalPrice = total*0.95f;
				break;
			case 2://从此开始总价格>1000,开关打开
			case 3:
				//总价格>1500 结算金额=总价格*0.88
				finalPrice = total*0.88f;
				break;
			case 4://从此开始总价格>2000,开关打开
			case 5:
			case 6:
			case 7:
			case 8:
			case 9:
				//2000<总价格<5000	 结算金额=总价格*0.8
				finalPrice = total*0.8f;
				break;
			default:
				//总价格>5000    	 结算金额=总价格*0.66
				finalPrice = total*0.66f;
				break;
			}
			
			System.out.println("消费的最终价格为"+finalPrice);
		}
	}

## 5 解读运行过程

根据switch结构的特点，我们的表达式只能为`byte`、`short`、`char`、`int`、`String`(JDK7以后)，
并且这个表达式仅能和`case`中字面值做等值比较。所以我们按500为一个区间把价格划分为不同等级，这样，我们就把一段连续的数转化为一个个区间等级。

注意：`double/int`结果为小数，我们需要强制转化为`int`,确保做整除运算

`case 2`为大于1000的开关，比如价格1200，1200/500=2，进入`case 2`,此case没有`break`，所以继续向下执行，到`case 3`处，执行计算逻辑并`break`，不再向下执行。`case4-case9`同理。`defalut`执行默认逻辑。如果没有任何`case`匹配则执行`default`。

## 6 小结

在功能上，`if`能够实现`switch`的任何实现，但是在相同功能场景下，`switch`要比`if`速度更快。

`switch`仅能适应等值判断，在必要时可以把区间判断转换为等值关系判断，如果不能转换还是老实用`if-else`语法。

`return`关键字为退出当前方法语句，而`break`是退出特定结构。两者控制的范围不同。狭义理解，`return` 退出的范围更大。

# 总结

通过几个实验，我们了解了分支结构的使用。利用分支结构我们可以轻松完成逻辑判断。

分为以下两种类型

- 条件分支：根据给定的条件进行判断，决定执行哪个分支的程序段。

  1. if..if...

  2. if...else...

  3. if..else if

  4. 嵌套if..else

- 开关分支：根据给定类型表达式的值进行等值判断，决定执行从哪一段分支开始执行。
	
```java
	switch...case （break）
```

# 实战练习

1、判断用户输入的月份(1~12)属于哪个季节（★）

2、判断输入的用户名密码是否匹配admin(用户名)/123(密码)（提示：String a与String b相等用`a.equals(b)`来判断）（★★）

3、控制台输入会员等级和商品价格，根据不同会员等级计算成交额(白金会员 8折、黄金会员 9折、普通会员 9.5折、非会员 原价)（★★）


4、用户输入税前工资和“五险一金”数额，计算出应缴税额和实发工资

### 背景介绍

工资个税的计算公式为： 
　　应纳税额＝（工资薪金所得 －“五险一金”个人负担部分－扣除数）× 适用税率－速算扣除数 

 2011年9月1日起调整后的7级超额累进税率：扣除数为3500元。 

　　全月应纳税所得额                   税率         速算扣除数(元) 
　　全月应纳税额不超过1500元          		 3%           0 
　　全月应纳税额超过1500元至4500元   		10%          	105 
　　全月应纳税额超过4500元至9000元   		20%          	555 
　　全月应纳税额超过9000元至35000元  		25%          	1005 
　　全月应纳税额超过35000元至55000元 		30%          	2755 
　　全月应纳税额超过55000元至80000元			35%          	5505 
　　全月应纳税额超过80000元            	45%          	13505
 
### 知识点分析

- 变量及基本数据类型
- 运算符
- 逻辑判断
- 基本输入输出


