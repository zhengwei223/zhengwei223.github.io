
# 实验一 实现用户登录窗口

> 目的：实现一个桌面窗口，输入指定用户名和密码提示登录成功。

## 前言

本章之前，我们已经接触了一些Java类，例如`Scanner`、`Arrays`、`Math`、`System`，这些都是JDK为我们提供的类，我们可以利用这些类实现很多复杂的功能。本次实验我们需要用到很多JDK为我们提供的类。

## 简单的窗体

	//包声明
	package chapter07;
	
	//引入所需要用的窗体控件包
	import javax.swing.JFrame;
	import javax.swing.JLabel;
	
	public class WindowsTest {
		
		public static void main(String[] args) {
			//利用JFrame类构建一个窗体对象,对象引用标识符frame
			JFrame frame = new JFrame();
			//利用窗体对象引用的setSize()方法调整frame的大小
			frame.setSize(400, 200);
			//利用JLable类构建一个Label对象，对象引用标识符lable
			JLabel label = new JLabel("Hello Java窗体");
			//利用frame的add方法把label添加到frame
			frame.add(label);
			//设置现实窗体
			frame.setVisible(true);
		}
	}


## 名词

### 包

#### 基本概念

Java中包的概念就和操作系统中文件夹的概念一样，我们会把硬盘上的文件，放在不同的文件夹中，通过文件路径，可以精确的获取到唯一一个文件。

#### 包的声明

代码中通过`package chapter07`声明了当前类是在`classpath`目录下的`chapter07`包中。包还可以用`.`来划分层次，例如`package com.lanqiao.chapter07`表示在`classpath`下com/lanqiao/chapter07的层次目录结构下。

通常情况，包的使用场景和文件夹相同，都是方便管理，我们会把拥有相同功能的类放到同一个包内。

#### 包的导入

使用包可以将功能相似的若干类保存在一个文件目录之中，但是这样一来就有可能出现包之间的互相访问的问题，当一个程序需要其他包中类的时候可以通过`import`关键字完成导入操作，我们之前经常使用的`Scanner`类就是通过`import java.util.Scanner`来导入使用的。

当我们需要导入一个包的的多个类是，可以通过`包路径.*`的方式导入当前包的所有类。例如上例中我们可以用`import javax.swing.*;`来代替原来两行的导入方式。

`java.lang`是Java默认运行时载入的包，不需要import就可以使用其中的类，例如我们常用的`System`类。

### 类和对象

将具有**相同属性**及**相同行为**的一组对象称为类（class）。

我们之前写过的代码最外层都是类的声明，但是严格上讲，我们写的类都没有什么具体含义，都只是完成main方法，实现了一些列过程性的代码，这种叫做**面向过程**的编程。

JFrame是一个窗体框架类，抽象了带有标题和边框的顶层窗口。这一类事物拥有长、宽、标题等属性，拥有添加子元素、显示等行为。

对象（object）是类实例化（具体化）的产物。实例化是一个从抽象到具体的过程，通过`new`关键字实现，`JFrame frame = new JFrame();`创建了一个JFrame类型的实例，标识符frame称为这个实例对象的引用。利用这个引用我们可以执行它的一些行为(frame.add(label)、frame.setVisible(true))。

![instantiation](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/chouxiang.png)

抽象过程，我们会归结一类事物的属性及行为，得到类。通过类，我们可以创建一些列类的实例。

## API文档的使用

[在线API文档](http://www.yq1012.com/api/ "在线文档")

### 文档结构说明

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/api.png)

### 关键部分

构造方法（Constructor）：简单的理解就是构造类实例对象的方法。我们用关键字`new`实例化对象时调用的方法。`JFrame frame = new JFrame();`中，`new JFrame()`调用下图中的构造方法之一。构造方法有很多个，可以选择不同参数列表来调用相应的构造方法。例如`JFrame frame = new JFrame("我是一个窗口");`。就是调用了`JFrame(String title) `这个构造方法。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/constructors.png)


方法（Method）:方法描述的就是类抽象的行为，`frame.add(label)`和`frame.setVisible(true)`都是调用的JFrame中的方法。但是这两个方法都继承自它的父类`Component`,关于继承我们后续还会介绍，这里大家先做了解。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/methods.png)

字段（Field）：类抽象的属性，通常我们不会直接去操作类的属性，而是通过方法来影响其属性。了解类的字段有助于大家理解类的结构。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/Field.png)

## 可视化编程的基本要素

我们看的的所有程序窗口都是由`容器+组件+布局`来完成展现的。

### 组件

组件和容器的区别仅仅是概念上的，因为所有容器也是组件，两者的区别在于它们的目的不同，正如术语本身的含义，组件是独立可是的控件，如文本框，复选框，按钮等等。

[http://com](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/component.png)

### 容器

抽象的考虑，容器本身也是一个组件，但是它有普通组件没有的特点，就是可以容纳其他组件。

容器可以分为顶级容器和普通容器，顶级容器可以直接创建并显示出来，普通容器必须依托一个顶级容器存在。例如JFrame就是一个顶级容器，我们可以直接new一个JFrame并`setVisible(true)`让其显示出来，而普通容器JPanel必须要存在于JFrame这类顶级容器中。

JFrame、JDialog、JWindow、JApplet都是顶级容器。用来容纳其他容器或组件。

JPanel、JScrollPane是最常见的普通容器。仅可以作为顶级容器的子容器存在。

### 布局

有了容器和组件，那么我们如何按照我们的设想来摆放这些内容呢。

每一个容器对象都有一个`setLayout();`方法，这个方法支持我们传入一个布局对象。

常用布局类

BorderLayout:添加到容器的组件都会依据一个设定好的方向摆放。

GridLayout:把容器按设定的行数和列数划分称网格。按照网格依次摆放组件。

FlowLayout:添加到容器的组件按照从左到右的顺序摆放。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/layout.png)

## 面向对象思想设计登录界面

思想本身就是一个比较抽象的东西，我们现在把它简单化为下面三部方法论

1、明确目标类和对象

我们的目标是创建一个登录窗口，那么登录窗口本身可以归为一个类（LoginWindow），每一个LoginWindow的实例就是一个实实在在的窗口。
	
	/**
	 * 登录窗口类
	 */
	class LoginWindow{
	
	}

2、确定属性

通过第一步，我们确定了一类事物的抽象LoginWindow，这一类事物会有一些我们所关心的属性，我们可能会关心窗口的宽和高，那么我们就可以为类添加属性。

	/**
	 * 登录窗口类
	 */
	class LoginWindow{
		int width;//类的属性，又叫做成员变量
		int height;
	}


3、确定方法(行为)

有了属性，我们的类还可以有一些行为，比如显示和关闭。这些行为在类中被称为方法。

	/**
	 * 登录窗口类
	 */
	class LoginWindow{
		int width;
		int height;
		/**
		 * 显示窗口，在这里我们可以为窗口添加所需要的内容
		 */
		public void show(){
					
		}
	}

## 代码

	package chapter07;

	import javax.swing.*;
	
	import java.awt.*;   //导入必要的包
	
	public class LoginWindow {
		
		int width;
		
		int height;
		
		//构造方法
		public LoginWindow(int width,int height){
			this.width = width;
			this.height = height;
		}
		
	    public void show(){
	    	//构建窗口顶级容器
	    	JFrame mainFrame = new JFrame("欢迎登陆");
	    	//根据属性设置宽和高
	        mainFrame.setSize(width, height);
	        //文本输入框,12个字符宽度
	    	JTextField loginNameTextField = new JTextField(12);
	    	//密码输入框,12个字符宽度
	    	JPasswordField passwordTextField = new JPasswordField(12);
	    	JLabel loginNameLabel = new JLabel("用户名");
	    	JLabel passwordLabel = new JLabel("密　码");//输入框标签
	    	JButton submit = new JButton("确认");
	    	JButton cancel = new JButton("取消");//按钮声明
	    	
	    	JPanel row1 = new JPanel();
	    	JPanel row2 = new JPanel();
	    	JPanel row3 = new JPanel();//三行子容器
	        
	        //设置布局
	    	mainFrame.setLayout(new GridLayout(3,1));
	        
	        row1.add(loginNameLabel); 
	        row1.add(loginNameTextField);//第一块面板添加用户名和文本框 
	        
	        row2.add(passwordLabel);
	        row2.add(passwordTextField);//第二块面板添加密码和密码输入框
	        
	        row3.add(submit);
	        row3.add(cancel); //第三块面板添加确认和取消
	        
	        mainFrame.add(row1);
	        mainFrame.add(row2);
	        mainFrame.add(row3);  //将三块面板添加到登陆框上面
	        //设置默认的窗口关闭按钮动作,不设置默认的关闭按钮是隐藏并不退出程序
	        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	        mainFrame.setVisible(true);
	         
	    }
	    
	    //主方法也可以写在任意的其他类中，只要导入LoginWindow所在包路径即可
	    public static void main(String[] args){
	        LoginWindow loginWindow = new LoginWindow(300,200);//构建LoginWindow对象
	        loginWindow.show();//显示Loginwindow对象
	    }
	}
## 详解

关键知识点：

### 属性（成员变量）

一个可以在类内部使用的变量，类的每一个方法都可以引用或赋值该变量。在示代码中，我们在构造方法中为这两个变量赋值，然后在show()方法引用这两个变量来设置窗口。

> 关于this关键字：this代表当前对象的引用，例如合同中经常会用到甲方和乙方，甲方和乙方分别代表签署合同的一个确切的实体代号。this也可以理解为一个代号，它是类实例化后对象的的代号。以本程序为例，我们new了一个LoginWindow实例，命名为loginWindow,这时构造方法中使用的this，就指的loginWindow这个实例对象。

### 方法（成员方法）

之前频繁的使用过main方法，还有new关键字调用的构造方法，它们都是比较特殊的方法。方法的声明格式如下。

	权限修饰符 返回值类型 方法名（参数列表）{
		//方法代码块
		//return 返回值类型数据
	}

**方法的返回值**

有些方法可能会产生一些结果，比如计算两个数的和。

	public int sum(int a,int b){
		return a+b;
	}

而我们的show方法不需要给出结果，所以使用了void声明返回值，代表没有返回值。

一旦方法声明了非void类型的返回值，那么方法体就必须return一个指定类型的返回值。

**参数列表**

方法在调用时，需要根据方法声明时提供的参数类型来调用，我们在`new LoginWindow(300,200);`时就遵循的我们声明的构造方法`public LoginWindow(int width,int height)`的参数列表。而show方法使用了无参列表，则调用时就不能传递参数。

**方法的重载**

如果多个方法拥有相同的名称，不同的参数列表（类型,数量），这些同名的方法就构成了方法的重载。调用时，会根据传递参数的不同，自动执行相应参数列表的方法体执行。

	public void test(){
		System.out.println("调用无参的构造方法");
	}
	
	public void test(int i){
		System.out.println("调用int类型参数的构造方法");
	}

	public void test(int i,int ii){
		System.out.println("调用两个int参数的构造方法");
	}

	public void test(String s){
		System.out.println("调用一个String参数的构造方法");
	}

	public String test(String s,String s){
		System.out.println("调用两个String参数的构造方法");
	}

以上都构成test方法的重载，都会根据不同的调用参数自动选择执行。要注意的是最后一个，重载成立情况下返回值类型也可以不同。但是单纯的返回值类型不同不构成重载。重载只跟参数列表有关。

### 构造方法

构造方法是一个比较特殊的方法，构造方法的声明不能有返回值，且名称必须和类名相同。如果不显性的声明，编译器会提供默认的没有参数的构造方法。但如果显性的声明，就不在提供默认无参的构造方法了。

### 静态变量和方法

`JFrame.EXIT_ON_CLOSE`引用的是一个JFrame静态变量。在JFrame的源码中是这样声明的。

	public static final int EXIT_ON_CLOSE = 3;

这个变量的特点是由`public static`修饰。我们这里着重理解`static`关键字。被`static`修饰的方法或成员变量可以直接被类访问，而不需要实例化对象。还记得我们获取随机数使用的`Math.random()`方法么，random就是Math类下的一个静态方法。

### 访问控制修饰符

我们在修饰方法时，用到了`public`关键字，这个关键字是用来声明方法的访问权限，尝试把show方法的访问修饰符换为`private`。然后编写如下程序运行

	package chapter07;
	public class Entrance{
		public static void main(String[] args){
			 LoginWindow loginWindow = new LoginWindow(300,200);//构建LoginWindow对象
			loginWindow.show();//显示Loginwindow对象
		}
	}

此时会报出`The method show() from the type LoginWindow is not visible`,意思就是LoginWindow中的show()方法是不可见的。正是因为我们的show方法设置为了private,private的方法不能被类外部访问的。

Java中，可以使用访问控制符来保护对类、变量、方法和构造方法的访问。Java支持4种不同的访问权限。

默认的，也称为 default，在同一包内可见，不使用任何修饰符。

私有的，以 private 修饰符指定，在同一类内可见。

公有的，以 public 修饰符指定，对所有类可见。

受保护的，以 protected 修饰符指定，对同一包内的类和所有子类可见。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/visit.png)


### 继承

找到JFrame在文档中的描述。

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/extend.png)

JFrame用extend关键字，继承了Frame类。还记得我们使用的add()方法么，它并没有出现在JFrame的方法摘要中，那么声明在哪里呢？

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/frameadd.png)

我们来总结一下这些类的继承关系

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/ClassDiagram.png)

那么这么复杂的继承关系为我们带来了什么呢？

1、良好的结构层次性

上文我们了解到了，一个容器它同时自身也是一个组件，它可以拥有组件的一般性质，比如长宽，显隐性等等，而它又拥有自己的独特性质，比如能添加其他组件到自身（add），设置布局对象。在逻辑上这种继承关系也能够很清晰的表达出来。

2、避免重复的方法和属性声明

容器拥有和组件相同的特性和行为，但又有自己的特性，如果声明为两个无关的类，势必会有大量的重复代码，也更利于扩展。

3、抽象的方法参数

父类相对子类是一个更加抽象的东西，更抽象就代表更广泛的范围。比如说明天中国会下雨，这句话就时抽象的，中国的任何一个城市下雨，都能验证我说的话。反观Container中的add方法，它的参数列表是一个Component类。而Component拥有众多的子类，那么我们这个add方法就可以支持很多中调用方式，参数可以是JLabel,JButton,JTextField，只要是Component的后代类的实例，都可以作为参数传入。

**方法的重写**

子类在继承父类的方法后，可以拥有与父类同名同参数的方法实现，叫做方法的重写。

**继承的限制**

Java不允许多继承，也就是一个类仅能拥有一个直接父类，不能够extend多个类。

**所有类的祖先**

有科学家指出所有生物的祖先都源自一个单细胞生物，通过不断的变化繁衍，变成了现在多姿多彩的生态世界。

在Java中，所有了类都源自一个祖先Object。如果我们不显性的声明类extend某一个类，那么这个类就默认继承了Object。

### 抽象类和接口

![](https://coding.net/u/lanqiao/p/lanqiao/git/raw/coding-pages/public/img/Java8/abstract.png)

abstract关键字，可以修饰类和方法。

abstract修饰的类代表该类是一个抽象类，抽象的类不能够被实例化，也就是说我们不可以通过`new Component();`来创建一个实例，因为abstract修饰的类通常是**不完整**的，在abstract的类中**可以存在**abstract修饰的方法。

abstract修饰的方法不可以有方法体。

	public abstract void test();

可以看到test方法并没有方法体。这就是抽象方法的特点。抽象方法仅能声明在抽象类中。

**接口**

接口中的每一个方法都是abstract（可以不显示声明）。接口中存在普通变量是没有意义，因为根本没有方法体来使用它。所以接口中的变量都必须声明为static。

接口弥补的Java单根继承所造成的局限性，一个类可以同时实现多个接口。


## 总结

### 面向对象的特点

抽象是面向对象的设计过程，目的是找到目标的关注点，包括**属性**和**行为**，通常行为会影响属性或收到属性的影响。更高级的抽象还会考虑到事物的层次性和逻辑性。

#### 封装

把属性和行为包装成类，把一些内部的过程和变量通过访问限制修饰符控制，保证了数据的隐私和过程的复用。

类封装的是一类事物的特点包括属性和行为。

方法封装的行为的具体过程。

#### 继承

通过extend关键字实现类的继承关系，继承类以后，子类可以拥有父类所暴漏的（遵循访问控制修饰符）属性和方法。继承关系可以更高效的利用重复代码。

#### 多态

字面的意思就是事物的多种形态。

方法多态性：重写和重载

重载在一个类的实例上，可以有相同名称的方法，但是又可以通过不同的参数列表拥有不同的实现结果。

重写是在子类与父类之间，子类继承父类的方法后，同样可以拥有同名方法的不同实现，这个过程叫做重写。

对象多态性：父类引用可以指向子类对象，`JFrame`类的`add(Component com)`方法可以传递任何Component的子类。也是对象多态性的体现。


## 实战练习

1、加你一个人类（Person）和学生类（Student），功能如下

a.Person包含4个属性name,addr,sex,age分别表示姓名，地址，性别，年龄用一个方法print()来打印这4个属性。

b.Student继承Person,并添加属性math,java存放数学和java成绩，重写print()方法打印出6个属性。

2、定义一个Instrument（乐器）类，并定义公有方法play(),在分别定义子类（Wind）管乐器，Percussion（打击乐器）,Stringed(弦乐器),从写play()方法，实现每种乐器独有的演奏方式。

3、设计三个游戏职业，每个职业都有各自的血量、魔法、防御和攻击力，并拥有普通攻击attack（），attack时，要根据攻击对象造成不同的伤害（输出伤害=攻击力-防御）。发挥自己的想象力。用面向对象的设计思想，设计描述这些职业的类。