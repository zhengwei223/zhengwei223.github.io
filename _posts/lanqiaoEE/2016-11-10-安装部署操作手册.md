---
layout: post

title: 安装部署操作手册

category: lanqiaoEE

tags: 文档说明

description: lemon部署手册

author: 丁彦涛

keywords:  lemon  部署

---

# LEMON部署手册（V1.0）

## 1.概述

　　该文档介绍了如何部署蓝桥软件学院教务管理平台（Lemon），其中使用的数据库为MySql，有详细的步骤，只需按照步骤操作，就可以正常运行程序。

## 2.预期读者

1.	Lemon系统潜在用户

2.	Lemon系统新手用户

## 3.部署步骤

### 3.1. 下载压缩文件

首先下载项目源码包lemon.war和tomcat压缩安装文件

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual001.png)

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual002.png)

### 3.2. 数据库安装

Linux  Centos6.5安装mysql步骤：

#### 3.2.1. 卸载掉原来的mysql

使用以下命令查看是有已经安装了mysql  

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual003.png)

如果已经安装了mysql，适情况卸载，使用如下命令:

```
[root@lanqiao /]# rpm -e mysql　// 普通删除模式

[root@lanqiao /]# rpm -e --nodeps mysql　　// 强力删除模式，如果使用上面命令删除时，提示有依赖的其它文件，则用该命令可以对其进行强力删除

```
在删除完以后我们可以通过 <font color='FF5809'>rpm -qa | grep mysql </font>命令来查看mysql是否已经卸载成功！！

#### 3.2.2. 通过yum来进行mysql的安装

使用如下命令得到yum服务器上mysql数据库的可下载版本信息：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual004.png)

然后我们通过输入以下命令安装mysql

```
[root@lanqiao /]# yum install -y mysql-server mysql mysql-devel
```

　　在等待了一番时间后，yum会帮我们选择好安装mysql数据库所需要的软件以及其它附属的一些软件。我们发现，通过yum方式安装mysql数据库省去了很多没必要的麻烦，当出现下面的结果时，就代表mysql数据库安装成功了!

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual005.png)

我们通过以下命令查看刚才安装的mysql数据库版本信息

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual006.png)

#### 3.2.3. 启动mysql服务

　　我们在安装完mysql数据库以后，会发现会多出一个mysqld的服务，这个就是咱们的数据库服务，我们通过输入<font color='FF5809'> service mysqld start</font> 命令就可以启动我们的mysql服务。

<font color='red'>注意：</font>如果我们是第一次启动mysql服务，mysql服务器首先会进行初始化的配置，如：

```
[root@lanqiao ~]# service mysqld start
```

```
初始化 MySQL 数据库： WARNING: The host 'lanqiao' could not be looked up with resolveip.
This probably means that your libc libraries are not 100 % compatible
with this binary MySQL version. The MySQL daemon, mysqld, should work
normally with the exception that host name resolving will not work.
This means that you should use IP addresses instead of hostnames
when specifying MySQL privileges !
Installing MySQL system tables...
OK
Filling help tables...
OK

To start mysqld at boot time you have to copy
support-files/mysql.server to the right place for your system

PLEASE REMEMBER TO SET A PASSWORD FOR THE MySQL root USER !
To do so, start the server, then issue the following commands:

/usr/bin/mysqladmin -u root password 'new-password'
/usr/bin/mysqladmin -u root -h xiaoluo password 'new-password'

Alternatively you can run:
/usr/bin/mysql_secure_installation

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the manual for more instructions.

You can start the MySQL daemon with:
cd /usr ; /usr/bin/mysqld_safe &

You can test the MySQL daemon with mysql-test-run.pl
cd /usr/mysql-test ; perl mysql-test-run.pl

Please report any problems with the /usr/bin/mysqlbug script!

                                                           [确定]
正在启动 mysqld：                                            [确定]

```

　　这时我们会看到第一次启动mysql服务器以后会提示非常多的信息，目的就是对mysql数据库进行初始化操作，当我们再次重新启动mysql服务时，就不会提示这么多信息了，如：

```
[root@xiaoluo ~]# service mysqld restart
停止 mysqld：                                             [确定]
正在启动 mysqld：                                          [确定]

```

　　我们在使用mysql数据库时，都得首先启动mysqld服务，我们可以 通过<font color='FF5809'>  chkconfig --list | grep mysqld </font>命令来查看mysql服务是不是开机自动启动，如：

```
[root@xiaoluo ~]# chkconfig --list | grep mysqld
mysqld             0:关闭    1:关闭    2:关闭    3:关闭    4:关闭    5:关闭    6:关闭
```

　　我们发现mysqld服务并没有开机自动启动，我们当然可以通过 <font color='FF5809'>chkconfig mysqld on </font>命令来将其设置成开机启动，这样就不用每次都去手动启动了

```
[root@xiaoluo ~]# chkconfig mysqld on
[root@xiaoluo ~]# chkconfig --list | grep mysql
mysqld             0:关闭    1:关闭    2:启用    3:启用    4:启用    5:启用    6:关闭
```

　　mysql数据库安装完以后只会有一个root管理员账号，但是此时的root账号还并没有为其设置密码，在第一次启动mysql服务时，会进行数据库的一些初始化工作，在输出的一大串信息中，我们看到有这样一行信息 ：

```
/usr/bin/mysqladmin -u root password 'new-password'　　// 为root账号设置密码
```

所以我们可以通过 该命令来给我们的root账号设置密码(<font color='red'>注意：</font>这个root账号是mysql的root账号，非Linux的root账号)

```
[root@xiaoluo ~]# mysqladmin -u root password 'root'　　// 通过该命令给root账号设置密码为 root
```

此时我们就可以通过  <font color='FF5809'>mysql -u root -p </font> 命令来登录我们的mysql数据库了

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual007.png)

### 3.3. 创建数据库

　　首先打开Navicat连接linu服务器上的MySQL数据库，本文用到的数据库名称为（lanqiaokf）。<font color='red'>(此处可能会出现无法连接到主机的现象是由于服务器端防火墙配置没有打开3306端口所致，具体解决方案见文档最后注意事项)</font>

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual008.png)

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual009.png)

然后sql，右键点击数据库lanqiao，选择点击 运行Sql文件…选项。

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual010.png)

点击文件后面蓝色箭头指向的按钮来选择文件，选择lemon.sql文件后，选择后点击  开始。

出现下图页面，证明倒入成功。

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual011.png)

### 3.4. Linux服务器安装tomcat7.0

　　linux下tomcat安装较为简单，只需解压tomcat压缩包到指定路径即可！

#### 3.4.1. 将事先准备好的tomcat压缩文件放到指定目录如下图所示：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual012.png)

#### 3.4.2. 使用如下命令解压到当前文件夹下：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual013.png)

解压后：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual014.png)

#### 3.4.3. 测试tomcat是否安装成功

192.168.10.4:8080出现如下页面则表面服务器端tomcat安装成功！

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual015.png)

### 3.5.	将lemon项目部署到服务器

部署之前首先找到tomcat的bin 目录并关闭tomcat服务器如下图：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual016.png)

通过SSH远程连接工具将事先备好的lemon.war放到tomcat webpp目录下：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual017.png)

回到bin目录重新启动tomcat：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual018.png)

至此部署工作全部完成！

### 3.6. 登录访问验证

在浏览器上访问<font color='red'>http://192.168.10.4:8080/lemon-web</font>，显示登陆页面，如下图所示：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual019.png)

默认账户dyt@lanqiao.org，密码111111，登录后主页面如下图所示：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual020.png)

## 4. 注意事项
### 4.1. nacicat 无法远程连接服务器mysql数据

解决方案：

在iptables中新增如下片段

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual021.png)

设置防火墙：

![典型技全栈术模型](http://lemon.lanqiao.org:8082/teaching/img/manual/manual022.png)

### 4.2. 创建数据库时一定保证其编码格式为utf-8

### 4.3. 本手册仅供参考。如果您已经完成其中数据库、tomcat服务器部分的部署可跳过此部分直接阅读第3.5节。






