---
layout: post
title: ES6(ES2015)-lesson7
category: es6
tags: es6 es2015
author: 郑未
keywords: lanqiao 蓝桥 培训 教程 前端 es6 es2015
description: 本章主要介绍es6对Unicode的支持；特别重要的是本章会介绍es6对模块化组件的支持
---
>内容提要

- Unicode：es6渐进增强地、非破坏性地全面支持Unicode
- Modules 模块：模块化开发已经是前端开发的标配，es6之前我们需要借助第三方工具如requirejs才能实现模块化开发，而es6内置了模块化支持

# Unicode

es6渐进增强地、非破坏性地全面支持Unicode，也就是说，新加入的特性并不影响老的代码的使用。

    // 与 ES5.1 相同
    console.log(`"𠮷".length == ${"𠮷".length}`);

    // 新的正则表达式行为，使用可选的‘u’修饰符用于处理码位
    console.log(`"𠮷".match(/./u)[0].length == ${"𠮷".match(/./u)[0].length}`);

    // ES5.1的写法是`反斜杠+u+码点`，新的形式可以通过添加一组大括号`{}`来表示超过四字节的码点
    console.log(`\u{20BB7}`);

    // new String ops
    console.log(`"𠮷".codePointAt(0) == ${"𠮷".codePointAt(0).toString(16)}`);

    // for-of iterates code points
    for(let c of "𠮷") {
      console.log(c);
    }

# Modules 模块

## 简介

ES6 在语言层面上支持使用模块来进行组件定义，将流行的JavaScript模块加载器（AMD、CommonJS）中的模式固化到了语言中。运行时行为由宿主的默认加载器定义，隐式异步模型 - 直到（全部）请求的模块均可用且经处理后，才会执行（当前模块内的）代码。

## 体验

    //下列代码放在lib/math.js中，导出一个函数和一个变量
    export function sum(x, y) {
      return x + y;
    }
    export var pi = 3.141593;

然后在[lesson7-2.js](https://coding.net/u/lanqiao/p/frontAdvance/git/blob/master/es6/lesson7-2.js)中这样使用：

    import * as math from './lib/math' //将整个模块导入并命名为math
    console.log("2π = " + math.sum(math.pi, math.pi));//使用math前缀调用模块的属性和函数

也可以使用解构赋值来导入一个模块，这样可以避免前缀的使用，请看[lesson7-3.js](https://coding.net/u/lanqiao/p/frontAdvance/git/blob/master/es6/lesson7-3.js)：

    import {sum,pi} from './lib/math'
    console.log("2π = " + sum(pi, pi));

## 解读

### export

我们先来讨论`export`。默认情况下，你在模块中的所有声明相对于模块而言都是本地的、私有的，**所有的声明都被限定在模块的作用域中，对其他脚本和模块全局不可见**。如果你希望公开在模块中声明的内容，并让其它模块加以使用，你一定要导出它们。想要导出模块的功能有很多方法，其中最简单的方式是添加`export`关键字。

你可以导出所有的最外层函数、类以及`var`、`let`或`const`声明的变量。

### import

当你运行的模块中包含一条`import`声明时，首先会加载被导入的模块；然后按依赖顺序执行每一个模块的主体代码；为了避免形成回环，所有已执行的模块都会被忽略。

## 深入

### Export列表

也可以不标记每一个被导出的变量，你只需要在花括号中按照列表的格式写下你想导出的所有名称,lesson7-1的代码可以改写成这样：

    function sum(x, y) {
      return x + y;
    }
    var pi = 3.141593;

    export {sum,pi};

### 重命名import和export

有时候，导出的名称会与你需要使用的其它名称产生冲突，ES6为你提供了重命名的方法解决这个问题，当你在导入名称时可以这样做：

    import {sum,pi as PI} from './lib/math'
    console.log("2π = " + sum(PI, PI));

同样，当你在导出的时候也可以重命名。你可能会想用两个不同的名称导出相同的值，这样的情况偶尔也会遇到：

    function v1() { ... }
    function v2() { ... }

    export {
      v1 as streamV1,
      v2 as streamV2,
      v2 as streamLatestVersion
    };

### Default exports

如果你想让自己的ES6模块有一个默认的导出，实现的方法很简单，默认导出与其它类型的导出相似，没有什么技巧可言，唯一的不同之处是它被命名为“`default`”。你可以用我们刚才讨论的重命名语法来实现：

    let myObject = {
      field1: value1,
      field2: value2
    };
    export {myObject as default};

这种简略的表达方法看起来更清爽：

    export default {
      field1: value1,
      field2: value2
    };

关键字`export default`后可跟随任何值：一个函数、一个类、一个对象字面量，只要你能想到的都可以。
现在我们来改写math.js:

    function sum(x, y) {
      return x + y;
    }
    var pi = 3.141593;

    export {sum as default,pi};

然后我们这样来书写lesson7-4.js：

    import sum from './lib/math'

    console.log(`sum(2,3)===${sum(2,3)}`);

这种简略的表达方法等价于`import {default as sum} from "./lib/math";`。

### 聚合模块

有时一个程序包中主模块的代码比较多，为了简化这样的代码，可以用一种统一的方式将其它模块中的内容聚合在一起导出，可以通过这种简单的方式将所有所需内容导入再导出：

    // world-foods.js - 来自世界各地的好东西

    // 导入"sri-lanka"并将它导出的内容的一部分重新导出
    export {Tea, Cinnamon} from "sri-lanka";

    // 导入"equatorial-guinea"并将它导出的内容的一部分重新导出
    export {Coffee, Cocoa} from "equatorial-guinea";

    // 导入"singapore"并将它导出的内容全部导出
    export * from "singapore";

