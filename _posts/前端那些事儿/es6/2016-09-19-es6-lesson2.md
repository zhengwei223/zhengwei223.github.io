---
layout: post
title: ES6(ES2015)-lesson2
category: es6
tags: es6 es2015
author: 郑未
keywords: lanqiao 蓝桥 培训 教程 前端 es6 es2015
p_cate: 前端那些事儿
description: 这一章讲解对象的增强表示，模板字符串，以及引入异步HTTP请求的下一代标准fetch API
---
>内容提要

- 增强的对象字面值表示
- 模板字符串
- 综合案例，引入异步HTTP请求的下一代标准`fetch API`

# 1.增强的对象字面值表示

本例代码：[lesson2-1.js](https://coding.net/u/lanqiao/p/frontAdvance/git/blob/master/es6/lesson2-1.js)

对象的字面值表示法被增强，可以设置构造时的`prototype`，`foo: foo`格式可以被简写，可以定义方法并执行super调用。这些增强让对象字面值和类声明更加紧密，为基于对象的设计带来便利。

```js
'use strict'
var theProtoObj = {
    name: 'protoName',
    toString(){
        return this.name;
    }
}
var obj = {
    // 设置原型. 
    __proto__     : theProtoObj,
    // 这是动态属性名，并不设置prototype或触发重复原型属性的早期错误检查.
    ['__proto__'] : 'somethingElse',
    // ‘handler: handler’的简写
    // handler,
    // 方法定义
    toString() {
     // 调用父类方法
     return "d " + super.toString();
    },
    // 动态计算属性名
    [ "prop_" + (() => 42)() ]: 42
};

console.log(obj.name);  //来自原型,protoName
console.log(obj['__proto__']);  //somethingElse
console.log(obj.handler);  //暂不支持，输出undefined
console.log(obj.toString());  //d protoName
console.log(obj['prop_42']);  //42
```

# 2.模板字符串 #

本例代码：[lesson2-2.js](https://coding.net/u/lanqiao/p/frontAdvance/git/blob/master/es6/lesson2-2.js)

模板字符串为字符串构建提供了语法糖。直接看代码学习吧，有详细注释。

```js
'use strict'
//基本字符串定义
var s1 = `This is a pretty little template string.`;

// 多行字符串
var s2 = `In ES5 this is
 not legal.`
console.log(s2);

var name = "Bob", time = "today";
//变量绑定
var s3 = `Hello ${name}, how are you ${time}?`;
console.log('s3===' + s3); 

//输出非转义字符串
console.log(String.raw`In ES5 "\n" is a line-feed.`);
```

# 3.综合案例：模板字符串、箭头函数、fetch

```js
//构造并发起HTTP请求
/**
访问https://api.github.com/search/repositories?q=javascript&sort=stars&per_page=10
获得github上有关javascript排名最高的10个库
**/

var searchType = 'repositories';
var key        = 'javascript';
var sort       = 'stars';
var per_page   = 10;
var url        = `https://api.github.com/search/${searchType}?q=${key}&sort=${sort}&per_page=${per_page}`;

//fetch是一个ajax库，可通过 npm install node-fetch --save-dev 安装然后如下使用
var fetch = require('node-fetch');
fetch(url)
  .then(res => res.json())//返回json
  .then(data => {                 //解析json
    data.items.map(v => {
        console.log(v.full_name);
    })
  });
```

需要注意的是，应该提前安装node-fetch:`npm install node-fetch --save-dev`，
输出结果：

```
twbs/bootstrap
facebook/react
getify/You-Dont-Know-JS
jquery/jquery
airbnb/javascript
electron/electron
meteor/meteor
moment/moment
mrdoob/three.js
nodejs/node
```

可以看到`bootstrap`和`react`是最受欢迎的两个与js相关的前端框架。

<p class="bg-warning"> 
node-fetch是node环境下的fetch包，如果要在浏览器环境下使用，应该检测浏览器对该API的支持。
</p>