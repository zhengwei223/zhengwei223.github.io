---
layout: post
title: 网页JavaScript高级应用
category: Web前端入门教程
tags: Web前端
description: 本小节主要介绍如何使用JavaScript正则表达式在表单验证中的验证。此外，还会讲解用纯文本保存JavaScript对象的数据格式JSON。
author: 曹小虎
keywords: lanqiao 蓝桥 全栈 教程 Web前端
---

> 本章目标

- 学习JavaScript标准库对象正则表达式
- 用正则表达式完成Form表单输入校验
- 掌握使用JSON数据格式存储和传输JS对象的方法


# 实验一：过滤出字符串里的数字

目的：

1. 掌握如何创建正则表达式
2. 掌握正则表达式的过滤字符串的方法
3. 掌握如何编写正则表达式

&emsp;&emsp;正则表达式是JavaScript标准库支持的一种对象类型，它的主要用途是用来匹配字符串中的特定内容。

## 1.1 定义页面内容

### 定义页面控件

&emsp;&emsp;在空白页面的内容区定义了一个单行文本框、一个按钮、一个多行文本框，代码如下：

    <!--网页内容区开始-->
    <input type="text" id="txtBox" style="width:250px;" />
    <br/><br/>
    <!-- 按钮的onclick属性定义了用户点击按钮时应该调用哪个函数 -->
    <input type="button" value="过滤出数字" style="width:250px;" onclick="processString();"/>
    <br/><br/>
    <!-- 我们会把过滤出来的数字拼接在多行文本框里面 -->
    <textarea id="txtArea" rows="6" cols="30" style="width:250px;">
    </textarea> 
    <!--网页内容区结束-->

&emsp;&emsp;完成之后打开浏览器可以看到：

 ![js_regexp_tutorial_filter_number](/public/img/js/js_regexp_tutorial_filter_number.png)

## 1.2 编写JavaScript函数

### 定义processString函数

&emsp;&emsp;在页面内容区的尾部追加下面的JS脚本定义：

    <script type="text/javascript">
     function processString(){
      //获得当行文本框内容
      var inputString = document.getElementById("txtBox").value;
      /* 在此处使用正则表达式处理字符串  */
      var  result = inputString;
      if(result != null){
        var text ="";
        for(var i=0;i<result.length;i++){
	      text += result[i] + "\r\n";//每追加一个数字进行一次回车和换行操作
	    }
	    document.getElementById("txtArea").value = text; 
      }

     }
    </script>

### 过滤第一个数字

&emsp;&emsp;找到JS示例代码中的第6行，把它替换成下面的内容：

    /*
     1.调用字符串对象的“match”函数
     2.把一个正则表达式的字面量作为参数传入
     3.我们打算把字符串里面的数字过滤出来，d就是digit的意思
     */
    var  result = inputString.match(/\d/);

&emsp;&emsp;在页面上输入内容，测试过滤效果：

 ![js_regexp_tutorial_filter_number_02](/public/img/js/js_regexp_tutorial_filter_number_02.gif)

### 过滤全部数字

&emsp;&emsp;为了把字符串里面所有符合条件的内容都匹配出来，我们需要给正则表达式的字面量一个全局匹配的标识。

&emsp;&emsp;找到JS示例代码中的第6行，把它替换成下面的内容：

    /*
     1.调用字符串对象的“match”函数
     2.把一个正则表达式的字面量作为参数传入
     3.我们打算把字符串里面的数字过滤出来，d就是digit的意思
     */
    var  result = inputString.match(/\d/g);

 ![js_regexp_tutorial_filter_number_03](/public/img/js/js_regexp_tutorial_filter_number_03.gif)

### 正确地显示数字

&emsp;&emsp;显然，“2017”在一起才表达一个完整的意义，其他表示月份和日期的数字也是这样。想要在正则表达式里面实现这个，就要再次改写传入“match”函数的正则表达式字面量。

&emsp;&emsp;找到JS示例代码中的第6行，把它替换成下面的内容：

    /*
     1.调用字符串对象的“match”函数
     2.把一个正则表达式的字面量作为参数传入
     3.我们打算把字符串里面的数字过滤出来，d就是digit的意思
     */
    var  result = inputString.match(/\d+/g);

&emsp;&emsp;刷新页面重新测试，可以看到：

 ![js_regexp_tutorial_filter_number_04](/public/img/js/js_regexp_tutorial_filter_number_04.gif)


# 实验一的解读

## 如何创建正则表达式

### 从字面量创建

&emsp;&emsp;从使用正则表达式字面量的语法可以快速创建对象，这是因为JS引擎会暗中把符合语法规则的字面量解释成一个对象。

    /* 使用控制台时间工具检查创建对象花费多少时间  */
    console.time('用字面量语法创建正则表达式');
    var re = /\d+/g;
    console.timeEnd('用字面量语法创建正则表达式');

&emsp;&emsp;在控制台输入以上代码，回车确认执行，可以看到：

 ![js_regexp_tutorial_demo_01](/public/img/js/js_regexp_tutorial_filter_number_05.gif)

&emsp;&emsp;控制台时间工具显示创建和声明这个变量花费了0.042毫秒。从变量“re”查看它的构造函数、尝试调用到输入正则表达式类型对象的各种方法的结构，都表明：这是一个货真价实的正则表达式对象。

&emsp;&emsp;

### 字面量语法特征

&emsp;&emsp;正则表达式的字面量语法需要分别以一个斜杠“/”开头和结尾，两个斜杠之间的字符串内容就是正则表达式模式（pattern），描述了字符串匹配模式。

&emsp;&emsp;位于字面量表达式结尾处的斜杠之后，可以关联一个或者多个正则表达式的标志。例如，在实验一里用于过滤数字的正则表达式字面量里面就关联了一个“g”字母，表示我们希望匹配出字符里面的全部数字——全局匹配。

 ![js_regexp_tutorial_filter_number_08](/public/img/js/js_regexp_tutorial_filter_number_08.png)

&emsp;&emsp;正则表达式字面量的末尾还可以关联另外两种标志：

- i&emsp;让正则表达式在匹配英文字母的时候不区分大小写，例如/test/i不仅可以匹配 字符串“test” ,还可以匹配 “Test” “TEST” “tEsT” 等字符串
- m&emsp;允许匹配多个行,比如可以匹配文本区元素(textarea)中的字


&emsp;&emsp;从控制台我们还可以看出：如果不关联标志“i”，那么正则表达式re的ignoreCase属性值为false；如果不关联标志“m”，那么正则表达式re的multiline属性值也为“false”。

### 使用构造函数

&emsp;&emsp;用构造函数创建正则表达式类型对象也是一种可选的方法：

    /* 使用控制台时间工具检查创建对象花费多少时间  */
    console.time('用构造函数创建正则表达式');
    var re1 = new RegExp("\\d+",'g');
    console.timeEnd('用构造函数创建正则表达式');

&emsp;&emsp;在控制台输入以上代码，回车确认执行，可以看到：

 ![js_regexp_tutorial_filter_number_06](/public/img/js/js_regexp_tutorial_filter_number_06.gif)

&emsp;&emsp;从控制台的输出结果可以看出，这种方法创建的正则表达式对象与用字面量语法的方法没有区别。唯一的区别是：它们花费的时间有些不同，后者比前者稍微慢了一点。

&emsp;&emsp;请问：这件事是偶然的吗？

&emsp;&emsp;

### 正则表达式构造函数的参数

&emsp;&emsp;用构造函数创建正则表达式对象，一共需要向构造函数传入两个字符串类型的参数。第一个字符串正则表达式模式（pattern）的内容，第二个字符串就是与该正则表达式关联的标志位。

&emsp;&emsp;在开发过程中,如果正则是已知的,则优先选择字面量语法,而构造器方式则是用于在运行时,通过动态创建字符串来构建正则表达式.

&emsp;&emsp;

## 如何使用正则表达式

&emsp;&emsp;除了实验一我们演示过的，通过String类型对象的match函数使用正则表达式过滤字符串的方法以外，我们还可以通过正则表达式对象的方法来过滤字符串。

### 使用由字面量定义的正则表达式

    while(re.test('2016年12月31日')){

      console.log(re.exec('2016年12月31日'));
    }

### 使用正则表达式对象



# 实验二:用正则表达式验证表单输入

目的：
1. 自定义正则表达式进行表单输入数据校验
2. 在校验表单输入时使用第三方JS插件

# 实验二的解读

# 实验三：文本里的JS对象——使用JSON数据格式

目的：

1. 掌握JSON语法
2. 掌握JSON和JavaScript对象之间的相互转换

# 实验三的解读